# custom_msg_and_srv_py

## Overview
This package demonstrates how to use custom service definitions in ROS2 Python. It provides example server and client nodes that use the `CapitalFullName` service defined in the `custom_msg_and_srv` package.

## Purpose
Learn how to use custom services in Python:
- Using custom service interfaces from C++ packages
- Implementing service servers and clients in Python
- Understanding the dependency relationship between interface and implementation packages

## Important: Build Order

**⚠️ You must build the `custom_msg_and_srv` package first** before building this package, as this package depends on the service interfaces generated by that package.

```bash
# Build the interface package first
colcon build --packages-select custom_msg_and_srv

# Then build this package
colcon build --packages-select custom_msg_and_srv_py --symlink-install

# Source the workspace
source install/setup.bash
```

## Prerequisites
- ROS2 Jazzy installed and sourced
- `colcon` build tools
- Python 3.8 or higher
- The `custom_msg_and_srv` package must be built first (see above)

## Building
```bash
cd ~/ros2_ws/src
# Ensure custom_msg_and_srv is built first
colcon build --packages-select custom_msg_and_srv
# Then build this package
colcon build --packages-select custom_msg_and_srv_py --symlink-install
source install/setup.bash
```

## Service Definition

The service is defined in the `custom_msg_and_srv` package:

### CapitalFullName.srv
```srv
string name
string surname
---
string capitalfullname
```

- **Request**: `name` and `surname` (strings)
- **Response**: `capitalfullname` (string) - Capitalized full name

## Usage

### Service Server
```bash
ros2 run custom_msg_and_srv_py capital_full_name_server
```

### Service Client
```bash
ros2 run custom_msg_and_srv_py capital_full_name_client
```

You can also pass name and surname as arguments:
```bash
ros2 run custom_msg_and_srv_py capital_full_name_client "John" "Doe"
```

**Note**: If you get "Package 'custom_msg_and_srv_py' not found", make sure you have:
1. Built the package: `colcon build --packages-select custom_msg_and_srv_py --symlink-install`
2. Sourced the workspace: `source install/setup.bash`
3. Rebuilt after any code changes

**Alternative**: You can also run the client directly as a Python script (after sourcing):
```bash
source install/setup.bash
python3 install/custom_msg_and_srv_py/lib/custom_msg_and_srv_py/capital_full_name_client "John" "Doe"
```

### Calling the Service from Command Line
```bash
ros2 service call /capitalize_full_name \
  custom_msg_and_srv/srv/CapitalFullName "{name: 'John', surname: 'Doe'}"
```

## Key Concepts
- **Service Definition**: Custom services are defined in `.srv` files in C++ (`ament_cmake`) packages
- **Interface Generation**: `rosidl_generate_interfaces()` generates interfaces for both C++ and Python
- **Python Import**: Import generated services from the interface package: `from custom_msg_and_srv.srv import CapitalFullName`
- **Service Implementation**: Handle requests and return responses in Python nodes
- **Package Dependencies**: Python packages that use custom interfaces depend on the C++ interface packages

## Why Separate Interface and Implementation?

In ROS 2, it's a best practice to:
- Define custom messages, services, and actions in `ament_cmake` (C++) packages
- Use those interfaces in both C++ and Python packages
- This avoids build conflicts and follows ROS 2 conventions

## Files
- `capital_full_name_server.py` - Example service server
- `capital_full_name_client.py` - Example service client
- `formatting.py` - Helper functions for name formatting

## Related Packages
- `custom_msg_and_srv` - C++ package that defines the `CapitalFullName` service interface
